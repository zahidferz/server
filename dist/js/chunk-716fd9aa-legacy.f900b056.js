(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-716fd9aa"],{"3a1a":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"flex mb-4 items-center justify-between"},[e._t("left",[a("h1",{staticClass:"gx-h5 text-black font-bold flex items-center"},[e._t("left-icon",[e.back?a("button",{staticClass:"flex items-center",on:{click:e.goBack}},[a("GxIcon",{attrs:{icon:"keyboard_backspace"}})],1):e.iconClickHandler||e.back?a("button",{staticClass:"flex items-center",on:{click:e.goBack}},[a("GxIcon",{attrs:{icon:e.icon}})],1):e.icon?a("GxIcon",{staticClass:"text-primary",attrs:{icon:e.icon}}):e._e()]),a("span",{staticClass:"font-bold ml-2"},[e._v(e._s(e.header))])],2)]),e._t("right")],2)},r=[],n=a("524e"),s={name:"GxDesktopHeader",components:{GxIcon:n["a"]},props:{header:{type:String,default:""},icon:{type:String,default:""},iconClickHandler:{type:Function,default:null},back:{type:Boolean,default:!1}},methods:{goBack:function(){this.iconClickHandler?this.iconClickHandler():this.$router.back()}}},c=s,i=a("2877"),l=Object(i["a"])(c,o,r,!1,null,null,null);t["a"]=l.exports},"4e3b":function(e,t,a){e.exports=a.p+"img/mo_001_6_exitousuario.28d06cde.svg"},"6d3a":function(e,t,a){},a62b:function(e,t,a){"use strict";var o=a("6d3a"),r=a.n(o);r.a},faa3:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("LayoutWebMobile",{attrs:{title:"Ajusta tu foto",icon:"keyboard_backspace","icon-click-handler":e.goBack}},[a("ResizeProfilePhoto",{attrs:{"image-src":e.imageSrc}})],1)},r=[],n=a("42b5"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"mo"===e.$mq?a("div",{staticClass:"flex-grow flex flex-col items-center p-4"},[a("p",{staticClass:"mb-8 text-center"},[e._v("Esta fotografía aparecerá en tu perfil, podrás cambiarla cuando quieras. ")]),a("div",[e.imageSrc?a("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"check-orientation":!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!0,"crop-box-resizable":!1,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e()],1),a("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[a("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),a("div",{staticClass:"flex-grow flex flex-col mt-8 items-center justify-end"},[a("GxButton",{attrs:{loading:e.loading},on:{click:e.onSave}},[e._v("Guardar")]),a("GxTextLink",{staticClass:"text-secondary-300 text-center",attrs:{to:{name:"uploadprofilephoto"}}},[e._v(" Elegir otra imagen ")])],1),e.showErrorAlert?a("GxCardModal",{attrs:{headline:"Ops, algo salió mal. Inténtalo de nuevo.","card-img":e.$utils.alertImages.Oops,alt:"Ops, algo salió mal. Inténtalo de nuevo."}}):e._e(),e.showSuccessAlert?a("GxCardModal",{attrs:{headline:"Foto actualizada","card-img":e.$utils.alertImages.Done,alt:"Foto actualizada"},on:{close:function(t){e.showSuccessAlert}}}):e._e()],1):a("div",{staticClass:"flex-grow flex flex-col items-center"},[a("GxDesktopHeader",{staticClass:"self-start",attrs:{icon:"keyboard_backspace",header:"Ajusta tu fotografía","icon-click-handler":e.goBack}}),a("p",{staticClass:"text-left mt-4 self-start mb-8"},[e._v("Esta fotografía aparecerá en tu perfil, podrás cambiarla cuando quieras. ")]),a("main",{staticClass:"flex-grow flex-col flex justify-center items-center"},[e.imageSrc?a("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!1,"crop-box-resizable":!1,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e(),a("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[a("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),a("div",{staticClass:"gx-controls mt-6 flex justify-start items-center"},[a("GxIcon",{staticClass:"mr-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"remove_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomout(t)}}}),a("input",{directives:[{name:"model",rawName:"v-model.number",value:e.deskRange,expression:"deskRange",modifiers:{number:!0}}],staticClass:"w-full cursor-pointer gx-range",attrs:{id:"volume",type:"range",name:"volume",min:"0",step:"1",max:"100"},domProps:{value:e.deskRange},on:{input:e.scaleImage,__r:function(t){e.deskRange=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}}),a("GxIcon",{staticClass:"ml-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"add_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomin(t)}}})],1),a("div",{staticClass:"mt-8 text-center flex flex-col items-center"},[a("GxButton",{attrs:{loading:e.loading},on:{click:e.onSave}},[e._v("Guardar")]),a("GxTextLink",{staticClass:"text-secondary-300 text-center mt-2",attrs:{to:{name:"uploadprofilephoto"}}},[e._v(" Elegir otra imagen ")])],1)],1),e.showSuccessAlert?a("GxCardModal",{attrs:{headline:"Foto actualizada","card-img":e.$utils.alertImages.Done,alt:"Foto actualizada"},on:{close:function(t){e.showSuccessAlert}}}):e._e(),e.showErrorAlert?a("GxCardModal",{attrs:{headline:"Ops, algo salió mal. Inténtalo de nuevo.","card-img":e.$utils.alertImages.Oops,alt:"Ops, algo salió mal. Inténtalo de nuevo."}}):e._e()],1)},c=[],i=(a("d3b7"),a("ac1f"),a("1276"),a("5530")),l=(a("96cf"),a("1da1")),u=a("95c3"),d=a.n(u),m=a("0d9e"),p=a("0ae0"),f=a("4c6a"),g=a("524e"),h=a("3a1a"),x=a("9b02"),b=a.n(x),k={get:b.a},v={name:"ResizeProfilePhoto",components:{GxCardModal:m["a"],VueCropper:d.a,GxIcon:g["a"],GxDesktopHeader:h["a"]},props:{imageSrc:{type:String,required:!0}},apollo:{company:f["LOCAL_COMPANY"],myAccount:{query:f["COMPANY_INFO"],variables:function(){return{companyNumber:this.company.number}},skip:function(){return!this.company}}},data:function(){return{file:null,company:null,croppedImage:null,customError:null,loading:!1,deskRange:50,showSuccessAlert:!1,showErrorAlert:!1,successAlertImg:a("4e3b")}},created:function(){this.imageSrc||this.$router.push({name:"uploadprofilephoto"})},methods:{goBack:function(){this.$router.push({name:"uploadprofilephoto"})},croppedImageToBase64:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){e.$refs.cropper.getCroppedCanvas().toBlob((function(e){var a=new FileReader;a.readAsDataURL(e),a.onloadend=function(){var e=a.result;t(e)}}))})));case 1:case"end":return t.stop()}}),t)})))()},onSave:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.croppedImageToBase64();case 4:return e.croppedImage=t.sent,t.next=7,e.$apollo.mutate({mutation:p["USER_UPDATE"],variables:{data:{image:e.croppedImage.split(",")[1]}},update:function(t,a){var o=a.data,r={query:f["COMPANY_INFO"],variables:{companyNumber:e.company.number}},n=t.readQuery(r),s=o.userUpdate.image+"?".concat((new Date).getTime());n.myAccount.image=s,t.writeQuery(Object(i["a"])({},r,{data:n})),console.log("Updated data with logo: ",s),e.$apollo.queries.myAccount.refetch()}});case 7:e.loading=!1,e.showSuccessAlert=!0,a=setTimeout((function(){e.showSuccessAlert=!1,e.$router.push({name:"dashboard"})}),3e3),e.$once("hook:destroyed",(function(){clearTimeout(a)})),t.next=20;break;case 13:t.prev=13,t.t0=t["catch"](1),e.loading=!1,e.customError=k.get(t.t0,"response.data.message","Hubo un error"),e.showErrorAlert=!0,o=setTimeout((function(){e.customError=null}),3e3),e.$once("hook:destroyed",(function(){clearTimeout(o)}));case 20:case"end":return t.stop()}}),t,null,[[1,13]])})))()},scaleImage:function(){var e=this.deskRange,t=e/50,a=this.$refs.cropper.scale;a(t)},deskZoomout:function(){this.deskRange>0&&(this.deskRange=this.deskRange-10,this.scaleImage())},deskZoomin:function(){this.deskRange<100&&(this.deskRange=this.deskRange+10,this.scaleImage())}}},_=v,w=(a("a62b"),a("2877")),y=Object(w["a"])(_,s,c,!1,null,null,null),C=y.exports,I={page:{title:"Foto de perfil",meta:[{name:"description",content:"Ajusta tu foto de perfil"}]},components:{LayoutWebMobile:n["a"],ResizeProfilePhoto:C},props:{imageSrc:{type:String,required:!0}},methods:{goBack:function(){this.$router.gxAnim="slide-right",this.$router.back()}}},S=I,A=Object(w["a"])(S,o,r,!1,null,null,null);t["default"]=A.exports}}]);
//# sourceMappingURL=chunk-716fd9aa-legacy.f900b056.js.map