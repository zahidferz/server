(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4137c6ab"],{"2c95":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("LayoutWebMobile",{attrs:{title:"Ajusta tu logotipo",icon:"keyboard_backspace","icon-click-handler":e.goBack}},[o("ResizeLogo",{attrs:{"image-src":e.imageSrc}})],1)},r=[],n=o("42b5"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return"mo"===e.$mq?o("div",{staticClass:"flex-grow flex flex-col items-center p-4"},[o("p",{staticClass:"mb-8 text-center"},[e._v("Este logotipo aparecerá en tu perfil y los documentos que emitas en Chain.")]),o("div",[e.imageSrc?o("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!0,"crop-box-resizable":!1,"check-orientation":!0,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e()],1),o("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[o("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),o("div",{staticClass:"flex-grow flex flex-col justify-end mt-8"},[o("GxButton",{attrs:{loading:e.loading},on:{click:e.onSubmit}},[e._v("Guardar")])],1),e.customError?o("GxCardModal",{attrs:{headline:e.customError,"card-img":e.$utils.alertImages.Oops,alt:e.customError,"text-body":"Vuelve a intentarlo"},on:{click:function(t){e.customError=!e.customError}}}):e._e(),e.showUpdateSuccessfulModal?o("GxCardModal",{attrs:{headline:"Logo actualizado","card-img":e.$utils.alertImages.Done,alt:"Logo actualizado"},on:{close:e.onSuccesModalClose}}):e._e()],1):o("div",{staticClass:"flex-grow flex flex-col items-center"},[e._m(0),o("p",{staticClass:"text-left mt-4 self-start"},[e._v("Este logotipo aparecerá en tu perfil y los documentos que emitas en Chain. ")]),o("main",{staticClass:"flex-grow flex-col flex justify-center items-center"},[e.imageSrc?o("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!1,"crop-box-resizable":!1,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e(),o("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[o("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),o("div",{staticClass:"gx-controls mt-6 flex justify-start items-center"},[o("GxIcon",{staticClass:"mr-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"remove_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomout(t)}}}),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.deskRange,expression:"deskRange",modifiers:{number:!0}}],staticClass:"w-full cursor-pointer gx-range",attrs:{id:"volume",type:"range",name:"volume",min:"0",step:"1",max:"100"},domProps:{value:e.deskRange},on:{input:e.scaleImage,__r:function(t){e.deskRange=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}}),o("GxIcon",{staticClass:"ml-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"add_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomin(t)}}})],1),o("div",{staticClass:"mt-8 text-center flex flex-col items-center"},[o("GxButton",{attrs:{loading:e.loading},on:{click:e.onSubmit}},[e._v("Guardar")]),o("GxTextLink",{staticClass:"text-secondary-300 text-center mt-2",attrs:{to:{name:"uploadcompanylogo",query:{edit:e.editMode}}}},[e._v(" Elegir otra imagen ")])],1),e.customError?o("GxCardModal",{attrs:{headline:e.customError,"card-img":e.$utils.alertImages.Oops,alt:e.customError,"text-body":"Vuelve a intentarlo"},on:{click:function(t){e.customError=!e.customError}}}):e._e(),e.showUpdateSuccessfulModal?o("GxCardModal",{attrs:{headline:"Logo actualizado","card-img":e.$utils.alertImages.Done,alt:"Logo actualizado"},on:{close:e.onSuccesModalClose}}):e._e()],1)])},s=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("header",{staticClass:"w-full  flex justify-start items-center mt-4"},[o("i",{staticClass:"material-icons-round iconSize text-primary mr-4"},[e._v("receipt")]),o("h4",{staticClass:"gx-h4 font-bold"},[e._v("Ajusta tu logotipo")])])}],i=(o("d3b7"),o("ac1f"),o("1276"),o("5530")),u=(o("96cf"),o("1da1")),l=o("95c3"),m=o.n(l),d=o("0d9e"),p=o("0ae0"),g=o("4c6a"),f=o("524e"),h={name:"ResizeLogo",components:{GxCardModal:d["a"],VueCropper:m.a,GxIcon:f["a"]},props:{imageSrc:{type:String,required:!0}},apollo:{company:g["LOCAL_COMPANY"],myAccount:{query:g["COMPANY_INFO"],variables:function(){return{companyNumber:this.company.number}},skip:function(){return!this.company}}},data:function(){return{file:null,succesTimeout:null,errorTimeout:null,croppedImage:null,customError:null,loading:!1,deskRange:50,company:null,showUpdateSuccessfulModal:!1,updateSuccessImg:o("64c2")}},computed:{editMode:function(){return this.$route&&this.$route.query.edit},companyLogo:function(){return this.myAccount&&this.myAccount.companies[0].company.companyLogo?this.myAccount.companies[0].company.companyLogo:null}},created:function(){this.imageSrc||this.$router.push({name:"uploadcompanylogo"})},methods:{toDrawerRight:function(){this.$router.push({name:"dashboard",query:{drawerRight:!0}})},croppedImageToBase64:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,o){e.$refs.cropper.getCroppedCanvas().toBlob((function(e){var o=new FileReader;o.readAsDataURL(e),o.onloadend=function(){var e=o.result;t(e)}}))})));case 1:case"end":return t.stop()}}),t)})))()},onSubmit:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,e.croppedImageToBase64();case 4:return e.croppedImage=t.sent,o=e.croppedImage.split(",")[1],t.next=8,e.$apollo.mutate({mutation:p["UPLOAD_COMPANY_LOGO"],variables:{companyNumber:e.myAccount.companies[0].company.companyNumber,data:{companyDocumentsLogo:o,companyLogo:o}},update:function(t,o){var a=o.data,r={query:g["COMPANY_INFO"],variables:{companyNumber:e.company.number}},n=t.readQuery(r),c=a.companyUpdateInfo.updatedCompany.companyDocumentsLogo+"?".concat((new Date).getTime());n.myAccount.companies[0].company.companyLogo=c,t.writeQuery(Object(i["a"])({},r,{data:n})),console.log("Updated data with logo: ",c),e.$apollo.queries.myAccount.refetch()}});case 8:e.loading=!1,e.showUpdateSuccessfulModal=!0,e.succesTimeout=setTimeout((function(){e.onSuccesModalClose()}),3e3),t.next=18;break;case 13:t.prev=13,t.t0=t["catch"](1),e.loading=!1,e.customError=e.$utils.parseServerError(t.t0),e.errorTimeout=setTimeout((function(){e.onErrorModalClose()}),3e3);case 18:case"end":return t.stop()}}),t,null,[[1,13]])})))()},onErrorModalClose:function(){this.errorTimeout&&clearTimeout(this.errorTimeout),this.customError=""},onSuccesModalClose:function(){this.succesTimeout&&clearTimeout(this.succesTimeout),this.showUpdateSuccessfulModal=!1,this.$route.query.edit?this.toDrawerRight():this.$router.push({name:"invoicepreview"})},scaleImage:function(){var e=this.deskRange,t=e/50,o=this.$refs.cropper.scale;o(t)},deskZoomout:function(){this.deskRange>0&&(this.deskRange=this.deskRange-10,this.scaleImage())},deskZoomin:function(){this.deskRange<100&&(this.deskRange=this.deskRange+10,this.scaleImage())}}},x=h,y=(o("a748"),o("2877")),b=Object(y["a"])(x,c,s,!1,null,null,null),v=b.exports,k={page:{title:"Ajustar logo",meta:[{name:"description",content:"Ajustar logo"}]},components:{LayoutWebMobile:n["a"],ResizeLogo:v},props:{imageSrc:{type:String,required:!0}},methods:{goBack:function(){this.$router.gxAnim="slide-right",this.$router.back()}}},w=k,C=Object(y["a"])(w,a,r,!1,null,null,null);t["default"]=C.exports},"64c2":function(e,t,o){e.exports=o.p+"img/mo_and_de_user_success.28d06cde.svg"},"7f77":function(e,t,o){},a748:function(e,t,o){"use strict";var a=o("7f77"),r=o.n(a);r.a}}]);
//# sourceMappingURL=chunk-4137c6ab-legacy.e939e3b4.js.map