(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4137c6ab"],{"2c95":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("LayoutWebMobile",{attrs:{title:"Ajusta tu logotipo",icon:"keyboard_backspace","icon-click-handler":e.goBack}},[o("ResizeLogo",{attrs:{"image-src":e.imageSrc}})],1)},r=[],s=o("42b5"),i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return"mo"===e.$mq?o("div",{staticClass:"flex-grow flex flex-col items-center p-4"},[o("p",{staticClass:"mb-8 text-center"},[e._v("Este logotipo aparecerá en tu perfil y los documentos que emitas en Chain.")]),o("div",[e.imageSrc?o("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!0,"crop-box-resizable":!1,"check-orientation":!0,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e()],1),o("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[o("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),o("div",{staticClass:"flex-grow flex flex-col justify-end mt-8"},[o("GxButton",{attrs:{loading:e.loading},on:{click:e.onSubmit}},[e._v("Guardar")])],1),e.customError?o("GxCardModal",{attrs:{headline:e.customError,"card-img":e.$utils.alertImages.Oops,alt:e.customError,"text-body":"Vuelve a intentarlo"},on:{click:function(t){e.customError=!e.customError}}}):e._e(),e.showUpdateSuccessfulModal?o("GxCardModal",{attrs:{headline:"Logo actualizado","card-img":e.$utils.alertImages.Done,alt:"Logo actualizado"},on:{close:e.onSuccesModalClose}}):e._e()],1):o("div",{staticClass:"flex-grow flex flex-col items-center"},[e._m(0),o("p",{staticClass:"text-left mt-4 self-start"},[e._v("Este logotipo aparecerá en tu perfil y los documentos que emitas en Chain. ")]),o("main",{staticClass:"flex-grow flex-col flex justify-center items-center"},[e.imageSrc?o("VueCropper",{ref:"cropper",attrs:{src:e.imageSrc,alt:"Source Image","auto-crop-area":.5,"min-container-width":350,"min-container-height":350,background:!0,rotatable:!0,"img-style":{width:"350px",height:"350px"},"aspect-ratio":1,zoomable:!1,"crop-box-resizable":!1,"min-crop-box-width":250,"min-crop-box-height":250}}):e._e(),o("div",{staticClass:"mt-4",staticStyle:{"font-size":"2rem"}},[o("GxIcon",{attrs:{icon:"rotate_90_degrees_ccw"},on:{click:function(t){return e.$refs.cropper.rotate(-90)}}})],1),o("div",{staticClass:"gx-controls mt-6 flex justify-start items-center"},[o("GxIcon",{staticClass:"mr-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"remove_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomout(t)}}}),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.deskRange,expression:"deskRange",modifiers:{number:!0}}],staticClass:"w-full cursor-pointer gx-range",attrs:{id:"volume",type:"range",name:"volume",min:"0",step:"1",max:"100"},domProps:{value:e.deskRange},on:{input:e.scaleImage,__r:function(t){e.deskRange=e._n(t.target.value)},blur:function(t){return e.$forceUpdate()}}}),o("GxIcon",{staticClass:"ml-4 text-xl text-primary-600",attrs:{"html-tag":"button",icon:"add_circle"},on:{click:function(t){return t.preventDefault(),e.deskZoomin(t)}}})],1),o("div",{staticClass:"mt-8 text-center flex flex-col items-center"},[o("GxButton",{attrs:{loading:e.loading},on:{click:e.onSubmit}},[e._v("Guardar")]),o("GxTextLink",{staticClass:"text-secondary-300 text-center mt-2",attrs:{to:{name:"uploadcompanylogo",query:{edit:e.editMode}}}},[e._v(" Elegir otra imagen ")])],1),e.customError?o("GxCardModal",{attrs:{headline:e.customError,"card-img":e.$utils.alertImages.Oops,alt:e.customError,"text-body":"Vuelve a intentarlo"},on:{click:function(t){e.customError=!e.customError}}}):e._e(),e.showUpdateSuccessfulModal?o("GxCardModal",{attrs:{headline:"Logo actualizado","card-img":e.$utils.alertImages.Done,alt:"Logo actualizado"},on:{close:e.onSuccesModalClose}}):e._e()],1)])},c=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("header",{staticClass:"w-full  flex justify-start items-center mt-4"},[o("i",{staticClass:"material-icons-round iconSize text-primary mr-4"},[e._v("receipt")]),o("h4",{staticClass:"gx-h4 font-bold"},[e._v("Ajusta tu logotipo")])])}],n=(o("e6cf"),o("1276"),o("5530")),l=o("95c3"),u=o.n(l),m=o("0d9e"),d=o("0ae0"),p=o("4c6a"),g=o("524e"),h={name:"ResizeLogo",components:{GxCardModal:m["a"],VueCropper:u.a,GxIcon:g["a"]},props:{imageSrc:{type:String,required:!0}},apollo:{company:p["LOCAL_COMPANY"],myAccount:{query:p["COMPANY_INFO"],variables(){return{companyNumber:this.company.number}},skip(){return!this.company}}},data(){return{file:null,succesTimeout:null,errorTimeout:null,croppedImage:null,customError:null,loading:!1,deskRange:50,company:null,showUpdateSuccessfulModal:!1,updateSuccessImg:o("64c2")}},computed:{editMode(){return this.$route&&this.$route.query.edit},companyLogo(){return this.myAccount&&this.myAccount.companies[0].company.companyLogo?this.myAccount.companies[0].company.companyLogo:null}},created(){this.imageSrc||this.$router.push({name:"uploadcompanylogo"})},methods:{toDrawerRight(){this.$router.push({name:"dashboard",query:{drawerRight:!0}})},async croppedImageToBase64(){return new Promise((e,t)=>{this.$refs.cropper.getCroppedCanvas().toBlob(t=>{var o=new FileReader;o.readAsDataURL(t),o.onloadend=function(){var t=o.result;e(t)}})})},async onSubmit(){this.loading=!0;try{this.croppedImage=await this.croppedImageToBase64();const e=this.croppedImage.split(",")[1];await this.$apollo.mutate({mutation:d["UPLOAD_COMPANY_LOGO"],variables:{companyNumber:this.myAccount.companies[0].company.companyNumber,data:{companyDocumentsLogo:e,companyLogo:e}},update:(e,{data:t})=>{const o={query:p["COMPANY_INFO"],variables:{companyNumber:this.company.number}},a=e.readQuery(o),r=t.companyUpdateInfo.updatedCompany.companyDocumentsLogo+"?"+(new Date).getTime();a.myAccount.companies[0].company.companyLogo=r,e.writeQuery(Object(n["a"])({},o,{data:a})),console.log("Updated data with logo: ",r),this.$apollo.queries.myAccount.refetch()}}),this.loading=!1,this.showUpdateSuccessfulModal=!0,this.succesTimeout=setTimeout(()=>{this.onSuccesModalClose()},3e3)}catch(e){this.loading=!1,this.customError=this.$utils.parseServerError(e),this.errorTimeout=setTimeout(()=>{this.onErrorModalClose()},3e3)}},onErrorModalClose(){this.errorTimeout&&clearTimeout(this.errorTimeout),this.customError=""},onSuccesModalClose(){this.succesTimeout&&clearTimeout(this.succesTimeout),this.showUpdateSuccessfulModal=!1,this.$route.query.edit?this.toDrawerRight():this.$router.push({name:"invoicepreview"})},scaleImage(){const e=this.deskRange,t=e/50,o=this.$refs.cropper.scale;o(t)},deskZoomout(){this.deskRange>0&&(this.deskRange=this.deskRange-10,this.scaleImage())},deskZoomin(){this.deskRange<100&&(this.deskRange=this.deskRange+10,this.scaleImage())}}},f=h,y=(o("a748"),o("2877")),x=Object(y["a"])(f,i,c,!1,null,null,null),b=x.exports,v={page:{title:"Ajustar logo",meta:[{name:"description",content:"Ajustar logo"}]},components:{LayoutWebMobile:s["a"],ResizeLogo:b},props:{imageSrc:{type:String,required:!0}},methods:{goBack(){this.$router.gxAnim="slide-right",this.$router.back()}}},C=v,_=Object(y["a"])(C,a,r,!1,null,null,null);t["default"]=_.exports},"64c2":function(e,t,o){e.exports=o.p+"img/mo_and_de_user_success.28d06cde.svg"},"7f77":function(e,t,o){},a748:function(e,t,o){"use strict";var a=o("7f77"),r=o.n(a);r.a}}]);
//# sourceMappingURL=chunk-4137c6ab.8d1a97a9.js.map